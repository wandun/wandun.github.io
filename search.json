[{"title":"使用百度api与oencv完成图片人脸检测并显示","url":"http://guokangjie.cn/2019/03/17/使用百度api与oencv完成图片人脸检测并显示/","content":"<p>﻿# 前言**：</p>\n<ul>\n<li>最近花了点时间搭建了一个个人博客，hh！  还是挺开心的！欢迎各位访问<br><a href=\"http://www.guokangjie.cn\" target=\"_blank\" rel=\"noopener\">www.guokangjie.cn</a></li>\n<li>其实快大二的时候，我就学了一部分opencv。但那时自己实在是太菜!! hh<br><img src=\"https://img-blog.csdnimg.cn/20190317174647653.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4MjYzMDgz,size_16,color_FFFFFF,t_70\" alt=\"无奈\"><br>最近看到bi站一个可爱的女博主的视频，使用python和opencv画出非常奈斯的图片，我知道必须使用一波opencv了  哈哈！！（地址: <a href=\"https://www.bilibili.com/video/av20349733?p=2\" target=\"_blank\" rel=\"noopener\">点击跳转</a>）<br>关于语言的使用,呃呃，选择使用一下当下上升趋势最快的 python 感受一下hh</li>\n</ul>\n<hr>\n<h1 id=\"言归正传\"><a href=\"#言归正传\" class=\"headerlink\" title=\"言归正传:\"></a><strong>言归正传</strong>:</h1><p>其实关于opencv自己本身就可以做出人脸识别了，但是这里先不说，使用一下百度提供的免费人脸检测API 地址：<a href=\"https://login.bce.baidu.com/?account=&amp;redirect=https://console.bce.baidu.com/ai/?fromai=1\" target=\"_blank\" rel=\"noopener\">点击跳转</a>，免费的，直接注册，再申请一个应用即可</p>\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><p>下载sdk  我这里下载的是python的 ，地址:<a href=\"https://ai.baidu.com/sdk#bfr\" target=\"_blank\" rel=\"noopener\">点击跳转</a><br>下完以后配置相关参数，在根据返回的参数完成图片展示即可 ，先看效果<br><img src=\"https://img-blog.csdnimg.cn/20190317175526954.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4MjYzMDgz,size_16,color_FFFFFF,t_70\" alt=\"效果图\"></p>\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"><span class=\"keyword\">import</span> cv2 <span class=\"keyword\">as</span> cv</span><br><span class=\"line\"><span class=\"keyword\">from</span> aip <span class=\"keyword\">import</span> AipFace</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 你的 APPID AK SK</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_api_client</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    APP_ID = <span class=\"string\">'你的 App ID'</span></span><br><span class=\"line\">    API_KEY = <span class=\"string\">'你的 Api Key'</span></span><br><span class=\"line\">    SECRET_KEY = <span class=\"string\">'你的 Secret Ke'</span></span><br><span class=\"line\">    client = AipFace(APP_ID, API_KEY, SECRET_KEY)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> client</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#将图片转为base64编码格式</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">img2base64</span><span class=\"params\">(path: str)</span>:</span></span><br><span class=\"line\">    f = open(path, <span class=\"string\">'rb'</span>)</span><br><span class=\"line\">    image = base64.b64encode(f.read())</span><br><span class=\"line\">    image64 = str(image, <span class=\"string\">'utf-8'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> image64</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show_image</span><span class=\"params\">(face_list, path: str)</span>:</span></span><br><span class=\"line\">    left = int(face_list[<span class=\"number\">0</span>][<span class=\"string\">'location'</span>][<span class=\"string\">'left'</span>])</span><br><span class=\"line\">    top = int(face_list[<span class=\"number\">0</span>][<span class=\"string\">'location'</span>][<span class=\"string\">'top'</span>])</span><br><span class=\"line\">    width = int(face_list[<span class=\"number\">0</span>][<span class=\"string\">'location'</span>][<span class=\"string\">'width'</span>])</span><br><span class=\"line\">    height = int(face_list[<span class=\"number\">0</span>][<span class=\"string\">'location'</span>][<span class=\"string\">'height'</span>])</span><br><span class=\"line\">    img = cv.imread(path)                                  <span class=\"comment\"># 426 71 98 85  height = 400  640</span></span><br><span class=\"line\">    print(<span class=\"string\">\"%d %d %d %d %d %d\"</span> % (left, top, width, height, img.shape[<span class=\"number\">0</span>], img.shape[<span class=\"number\">1</span>]))</span><br><span class=\"line\">    cv.rectangle(img, (left, top), (left+width, top+height), (<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">255</span>), <span class=\"number\">3</span>)</span><br><span class=\"line\">    cv.imshow(<span class=\"string\">\"check face\"</span>, img)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 如果有可选参数</span></span><br><span class=\"line\">options = &#123;&#125;</span><br><span class=\"line\">options[<span class=\"string\">\"face_field\"</span>] = <span class=\"string\">\"age\"</span></span><br><span class=\"line\">options[<span class=\"string\">\"max_face_num\"</span>] = <span class=\"number\">2</span></span><br><span class=\"line\">options[<span class=\"string\">\"face_type\"</span>] = <span class=\"string\">\"LIVE\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">image_type = <span class=\"string\">\"BASE64\"</span></span><br><span class=\"line\">client = get_api_client()</span><br><span class=\"line\">image64 = img2base64(<span class=\"string\">'image/002.jpg'</span>)</span><br><span class=\"line\">res = client.detect(image64, image_type, options)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> res[<span class=\"string\">'error_code'</span>] == <span class=\"number\">0</span>:</span><br><span class=\"line\">    face_list = res[<span class=\"string\">'result'</span>][<span class=\"string\">'face_list'</span>]</span><br><span class=\"line\">    show_image(face_list,<span class=\"string\">'image/002.jpg'</span>)</span><br><span class=\"line\">    cv.waitKey(<span class=\"number\">0</span>)</span><br><span class=\"line\">    cv.destroyAllWindows()</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    print(<span class=\"string\">\"调用api失败\"</span>)</span><br></pre></td></tr></table></figure>\n<p>写到这里我不禁感叹一句<strong>API</strong>大法好！！！  过几天下次博客使用opencv完成该部分工作</p>\n","categories":["python","opencv"],"tags":["python","opencv"]},{"title":"属于自己的个人博客","url":"http://guokangjie.cn/2019/03/15/使用hexo搭建个人博客/","content":"<h1 id=\"闲聊\"><a href=\"#闲聊\" class=\"headerlink\" title=\"闲聊\"></a>闲聊</h1><p>最近一直希望自己能 弄一个属于自己的个人博客！但是也不想自己买一个服务器搭建一个，除了能了解一下项目的部署，搭建一个博客实在没有必要，毕竟现在博客网站实在太多了，而且自己买一个服务器实在不划算！嗯，好吧平穷使我正直！！hhh</p>\n<p><img src=\"/images/temp/2.jpeg\" alt=\"无奈\"></p>\n","categories":["零零散散"],"tags":["零零散散"]},{"title":"about","url":"http://guokangjie.cn/about/index.html","content":"","categories":[],"tags":[]},{"title":"project","url":"http://guokangjie.cn/project/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"http://guokangjie.cn/tag/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"http://guokangjie.cn/category/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"http://guokangjie.cn/search/index.html","content":"","categories":[],"tags":[]},{"title":"link","url":"http://guokangjie.cn/link/index.html","content":"","categories":[],"tags":[]}]